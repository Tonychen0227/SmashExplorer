@model VisualizeSeedsModel

<!DOCTYPE HTML>
<html>
<head>
<script>
    window.onload = function () {
        var dataPoints = []

        @foreach (var dataPoint in Model.DataPoints)
        {
            @:dataPoints.push({ x: @dataPoint.NormalizedPlacement.ToString(), y: @dataPoint.SPR, title: "@dataPoint.PlacementOrdinal (@dataPoint.SPR SPR)", label: "@dataPoint.Name - @dataPoint.Seed seed" });
        }

        const data = {
            datasets: [{
                label: 'SPR',
                data: dataPoints,
                backgroundColor: 'rgb(255, 39, 104)',
                pointRadius: 5
            }],
        };

        const config = {
            type: 'scatter',
            data: data,
            options: {
                plugins: {
                    tooltip: {
                        callbacks: {
                            title: function (tooltipItem, data) {
                                console.log(tooltipItem);
                                return tooltipItem[0].raw.title;
                            },
                            label: function (tooltipItem, data) {
                                return tooltipItem.raw.label;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        type: 'linear',
                        position: 'bottom',
                        title: {
                            display: true,
                            text: 'Placement',
                            font: {
                                size: 20,
                                weight: 'bold',
                                lineHeight: 1.2,
                            },
                            padding: { top: 20, left: 0, right: 0, bottom: 0 }
                        },
                        ticks: {
                            callback: function (val, index) {
                                // Hide the label of every 2nd dataset
                                if (val == -1) {
                                    return 0;
                                }

                                var array = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129]

                                return array[val]
                            },
                            stepSize: 1
                        },
                        min: -1
                    },
                    y: {
                        type: 'linear',
                        position: 'bottom',
                        title: {
                            display: true,
                            text: 'SPR',
                            font: {
                                size: 20,
                                weight: 'bold',
                                lineHeight: 1.2,
                            },
                            padding: { top: 20, left: 0, right: 0 }
                        },
                        ticks: {
                            stepSize: 1
                        }
                    }
                }
            }
        };

        const myChart = new Chart(
            document.getElementById('myChart'),
            config
        );
	}
</script>
</head>
<body>
    <div class="jumbotron">
        <h1>Seed Visualizer</h1>
        <h3><a href="https://www.smash.gg/@Model.Event.Slug">@Model.Event.Name</a> @@ @Model.Event.TournamentName<sup>Top 128 only</sup></h3>
        <p>SPR = <a href="https://www.pgstats.com/articles/introducing-spr-and-uf" target="_blank">Seed Performance Rating</a></p>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    @if (string.IsNullOrWhiteSpace(Model.Message))
    {
        <canvas id="myChart" class="col-sm-12" style="height:@((Model.DataPoints.Max(x => x.SPR) - @Model.DataPoints.Min(x => x.SPR))*60)px"></canvas>
        <div class="col-sm-12">
            <h3>Standings and SPR (Top 128 only)</h3>
            <div style="overflow-y: scroll; height: 500px; margin-top: 30px">
                <table class="table table-hover">
                    <tr>
                        <th>Entrant</th>
                        <th>Placement</th>
                        <th>Seed</th>
                        <th>SPR</th>
                    </tr>
                    @foreach (var dataPoint in Model.DataPoints)
                    {
                        <tr>
                            <td>@dataPoint.Name</td>
                            <td>@dataPoint.Placement</td>
                            <td>@dataPoint.Seed</td>
                            <td>@dataPoint.SPR</td>
                        </tr>
                    }
                </table>
            </div>
        </div>
    }
    else
    {
        <h1>@Model.Message</h1>
    }
</body>
</html>